<head>
    <meta charset="UTF-8">
    <title>Main Page</title>
    <style>
        #authSection {
            margin-top: 30px;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
            background: #f1f2f6;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(44, 62, 80, 0.08);
        }
        #authError {
            color: #d63031;
            text-align: center;
            margin-top: 10px;
        }
    </style>
</head>
<body>
<h1>Welcome!</h1>
<a th:href="@{/register}"><button>Register</button></a>
<a th:href="@{/login}"><button>Login</button></a>

<div id="authSection">
    <label for="tokenInput">Paste your token:</label>
    <input type="text" id="tokenInput" style="width:100%; margin-top:5px;" />
    <button id="authBtn" style="width:100%; margin-top:10px;">Authenticate</button>
    <div id="authError"></div>
</div>

<script>
    document.getElementById('authBtn').onclick = async function() {
        const token = document.getElementById('tokenInput').value;
        document.getElementById('authError').textContent = '';
        const response = await fetch('/authenticate', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({token})
        });
        if (response.ok) {
            window.location.href = '/account';
        } else {
            document.getElementById('authError').textContent = 'Invalid token. Please try again.';
        }
    };
</script>
</body>